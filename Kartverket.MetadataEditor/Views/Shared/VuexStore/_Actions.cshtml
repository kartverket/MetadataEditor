<script>
    var Actions = {
        updateField: function (context, payload) {
            context.commit(payload.mutation, payload.value);
        },
        addMultilingualKeyword: function (context, payload) {
            var value = payload.value !== undefined ? payload.value : "";
            context.commit('addValueToArray', { arrayName: 'Keywords' + payload.keywordName, value: value });
        },
        removeMultilingualKeyword: function (context, payload) {
            var norwegianValue = context.getters['Keywords' + payload.keywordName][payload.keywordIndex];
            var englishKeywordKey = payload.keywordName + "_" + norwegianValue;
            var englishKeywordIndex = null;
            var englishKeywordValue = null;

            context.getters['KeywordsEnglish'].forEach(function (englishKeyword, index) {
                if (englishKeyword.Key == englishKeywordKey) {
                    englishKeywordIndex = index;
                    englishKeywordValue = englishKeyword.Value;
                }
            });

            if (englishKeywordIndex !== null) {
                context.commit('removeValueFromArray', { arrayName: 'KeywordsEnglish', arrayIndex: englishKeywordIndex }); // Remove english keyword value
            }
            context.commit('removeValueFromArray', { arrayName: 'Keywords' + payload.keywordName, arrayIndex: payload.keywordIndex }); // Remove norwegian keyword
        },
        updateMultilingualKeyword: function (context, payload) {
            var oldNorwegianValue = context.getters['Keywords' + payload.keywordName][payload.keywordIndex];
            var oldEnglishKeywordKey = payload.keywordName + "_" + oldNorwegianValue;
            var oldEnglishKeywordIndex = null;
            var oldEnglishKeywordValue = null;

            context.getters['KeywordsEnglish'].forEach(function (englishKeyword, index) {
                if (englishKeyword.Key == oldEnglishKeywordKey) {
                    oldEnglishKeywordIndex = index;
                    oldEnglishKeywordValue = englishKeyword.Value;
                }
            });

            if (payload.language == 'no') { // If keyword field is for a norwegian keyword

                var newEnglishKeywordValue = { // Add new english keyword
                    Key: payload.keywordName + "_" + payload.value,
                    Value: oldEnglishKeywordValue
                };
                if (oldEnglishKeywordIndex !== null) {
                    context.commit('updateArrayValue', { arrayName: 'KeywordsEnglish', arrayIndex: oldEnglishKeywordIndex, value: newEnglishKeywordValue }); // Update english keyword value
                } else {
                    context.commit('addValueToArray', { arrayName: 'KeywordsEnglish', value: newEnglishKeywordValue }); // Update english keyword value
                }
                context.commit('updateArrayValue', { arrayName: 'Keywords' + payload.keywordName, arrayIndex: payload.keywordIndex, value: payload.value }); // Update norwegian keyword

            } else if (payload.language == 'en') { // If keyword field is for an english keyword

                var newEnglishKeywordValue = { // Add new english keyword
                    Key: payload.keywordName + "_" + oldNorwegianValue,
                    Value: payload.value
                };
                context.commit('updateArrayValue', { arrayName: 'KeywordsEnglish', arrayIndex: oldEnglishKeywordIndex, value: newEnglishKeywordValue }); // Update english keyword value

            }
        }
    }
</script>
